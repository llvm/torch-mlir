# Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
# See https://llvm.org/LICENSE.txt for license information.
# SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
# Also available under a BSD-style license. See LICENSE.

# This file describes the sets of tests expected to fail for each config.
# This information is deliberately kept in a side table, rather than
# in-situ on the test, as a deliberate layering decision: tests should
# have unique keys to identify them and enable side tables of various kinds
# (this includes down into lower parts of the stack, where a side table
# might be used to keep more elaborate sets of testing configurations).

from torch_mlir_e2e_test.test_suite import COMMON_TORCH_MLIR_LOWERING_XFAILS

REFBACKEND_XFAIL_SET = COMMON_TORCH_MLIR_LOWERING_XFAILS

EAGER_MODE_XFAIL_SET = {
    # RefBackend fails
    "TableBatchEmbeddingModule_basic",
    "QuantizedMLP_basic"
}

# Write the TOSA set as a "passing" set as it is very early in development
# and very few tests work yet.
TOSA_PASS_SET = {
    "ElementwiseUnaryModule_basic",
    "ElementwiseBinaryModule_basic",
    "ElementwiseSigmoidModule_basic",
    "ElementwiseExpModule_basic",
    "ElementwiseReluModule_basic",
    "ElementwiseFloorModule_basic",
    "ElementwiseLogModule_basic",
    "ElementwiseBinaryStaticShapeModule_basic",
    "ElementwiseMinimumModule_basic",
    "ElementwiseMinimumIntModule_basic",
    "ElementwiseMaximumModule_basic",
    "ElementwiseMaximumIntModule_basic",
    "TanhBackward_basic",
    "ElementwiseAddModule_basic",
    "ReturnThreeTensorFloat32_basic",
    "AddCMulModule_basic",
    "AddCDivModule_basic",
    "SqueezeModule_broadcast",
    "BoolTensorReturnFalseModule_basic",
    "BoolTensorReturnTrueModule_basic",
    "BoolTensorReturnMixedModule_basic",
    "BoolTensorHandleSignless_basic",
    "ElementwiseRsqrtModule_basic",
    "SqueezeModule_static",
    "SqueezeModule_noUnitDim",
    "SqueezeModule_allUnitDim",
    "TModuleRank1_basic",
    "TModuleRank0_basic",
    "ElementwiseToDtypeIdentityModule_basic",
    "View1DFoldModule_basic",
    "UnsafeView1DFoldModule_basic",
    "SqueezeDimModule_static",
    "SqueezeDimModule_identity",
    "SqueezeDimModule_unitDim",
    "ReturnTwoTensorF32I64_basic",
    "ElementwisePowModule_basic",
    "BmmModule_basic",
    "MmDagModule_basic",
    "Matmul4dStatic_basic",
    "Matmul_dot",
    "Matmul_3d",
    "RsubFloatModule_basic",
    "RsubFloatModule_noalpha_basic",
    "ElementwiseGtFloatScalarModule_basic",
    "ElementwiseGtIntScalarModule_basic",
    "ElementwiseGtMixed2ScalarModule_basic",
    "ElementwiseGtFloatTensorModule_basic",
    "ElementwiseGtIntTensorModule_basic",
    "ElementwiseLtFloatScalarModule_basic",
    "ElementwiseLtIntScalarModule_basic",
    "ElementwiseLtDiffWidthScalarModule_basic",
    "ElementwiseLtFloatTensorModule_basic",
    "ElementwiseLtIntTensorModule_basic",
    "ElementwiseEqFloatScalarModule_basic",
    "ElementwiseEqIntScalarModule_basic",
    "ElementwiseEqDiffWidthScalarModule_basic",
    "ElementwiseEqFloatTensorModule_basic",
    "ElementwiseEqIntTensorModule_basic",
    "ElementwiseMulScalarModule_int",
    "ElementwiseMulScalarModule_float",
    "ElementwiseMulTensorIntModule_basic",
    "ElementwiseDivScalarModule_basic",
    "ElementwiseSubScalarFloatModule_basic",
    "ElementwiseAddScalarFloatModule_basic",
    "ElementwiseMulScalarModule_float",
    "ElementwiseCeilModule_basic",
    "ElementwiseReciprocalModule_basic",
    "TypePromotionAlphaWiderModule_basic",
    "Conv2dWithPaddingDilationStrideStaticModule_basic",
    "BatchNorm1DModule_basic",
    "BatchNorm1DWith2DInputModule_basic",
    "BatchNorm2DModule_basic",
    "BatchNorm3DModule_basic",
    "FlattenStaticModule_basic",
    "FlattenRank0Module_basic",
    "ElementwiseFlattenBroadcastModule_basic",
    "SquareModule_basic",
    "MaxPool2dStaticModule_basic",
    "ResNet18StaticModule_basic",
    "NativeLayerNormModule4D_basic",
    "LayerNormNormalizeOverAllDimsModule_basic",
    "PermuteModule_basic",
    "PermuteNegativeIndexModule_basic",
    "ElementwiseLog2Module_basic",
    "Threshold1dIntI32Module_basic",
    "Threshold1dFloatModule_basic",
    "Threshold2dFloatModule_basic",
    "Threshold3dFloatModule_basic",
    "ElementwiseSubScalarIntModule_basic",
    "ElementwiseAddScalarIntModule_basic",
    "ElementwiseMulScalarModule_basic",
    "ZerosModuleDefaultDtype_basic",
    "ZerosModuleInt2D_basic",
    "ZerosModuleInt3D_basic",
    "ZerosModuleFloat2D_basic",
    "ZerosModuleFloat3D_basic",
    "ZerosModuleFalsePinMemory_basic",
    "OnesModuleDefaultDtype_basic",
    "OnesModuleInt_basic",
    "OnesModuleFloat_basic",
    "OnesModuleFalsePinMemory_basic",
    "NewZerosModuleDefaultDtype_basic",
    "NewZerosModuleInt2D_basic",
    "NewZerosModuleInt3D_basic",
    "NewZerosModuleFloat2D_basic",
    "NewZerosModuleFloat3D_basic",
    "NewZerosModuleFalsePinMemory_basic",
    "NewOnesModuleDefaultDtype_basic",
    "NewOnesModuleInt2D_basic",
    "NewOnesModuleInt3D_basic",
    "NewOnesModuleFloat2D_basic",
    "NewOnesModuleFloat3D_basic",
    "NewOnesModuleFalsePinMemory_basic",
    "SiluModule_basic",
    "DropoutEvalIntModule_basic",
    "DropoutEvalFloatModule_basic",
    "ContiguousModule_basic",
    "DropoutModule_basic",
    "ViewExpandModule_basic",
    "ViewExpandOnesModule_basic",
    "ViewExpandOnesBeforeAndAfterModule_basic",
    "ViewExpandOnesMiddleModule_basic",
    "ViewExpandCollapseModule_basic",
    "ViewExpandCollapseWithOnesModule_basic",
    "ViewCollapseInferredDimModule_basic",
    "ViewExpandInferredDimModule_basic",
    "ViewNoChangeStaticModule_basic",
    "UnsafeViewExpandModule_basic",
    "ReshapeCollapseModule_basic",
    "ElementwiseGeluModule_basic",
    "GeluBackwardModule_basic",
    "ElementwiseNeIntScalarModule_basic",
    "ElementwiseNeFloatTensorModule_basic",
    "Convolution2DStaticModule_basic",
    "ElementwiseNegModule_basic",
    "TestMultipleTensorReturn_basic",
    "AdaptiveAvgPool2dUnitOutputSizeStaticModule_basic",
    "BaddbmmDynamicModule_basic",
    "BaddbmmStaticModule_basic",
    "BaddbmmWithAlphaBetaModule_basic",
    "BaddbmmWithAlphaModule_basic",
    "BaddbmmWithBetaModule_basic",
    "BaddbmmBroadcast1DInputModule_basic",
    "BaddbmmBroadcast2DInputModule_basic",
    "NumpyTRank1Module_basic",
    "NumpyTRank2Module_basic",
    "NumpyTRankNStaticModule_basic",
    "NumpyTRankNDynamicModule_basic",
    "EmbeddingModuleI32Static_basic",
    "TModuleRank2_basic",
    "TransposeIntModule_basic",
    "TransposeIntNegDimsModule_basic",
    "ArgmaxModule_keepDim",
    "ArgmaxModule_with_dim",
    "_LogSoftmaxModuleStable_basic",    
}

LTC_XFAIL_SET = {
    "AdaptiveAvgPool2dNonUnitOutputSizeDynamicModule_basic",
    "AdaptiveAvgPool2dNonUnitOutputSizeStaticModule_basic",
    "AdaptiveAvgPool2dUnitOutputSizeDynamicModule_basic",
    "AdaptiveAvgPool2dUnitOutputSizeStaticModule_basic",
    "AddIntModule_basic",
    "AllBoolFalseModule_basic",
    "AllBoolTrueModule_basic",
    "AnyBoolFalseModule_basic",
    "AnyBoolTrueModule_basic",
    "ArangeDtypeFloatModule_basic",
    "ArangeDtypeIntModule_basic",
    "ArangeFalsePinMemoryModule_basic",
    "ArangeFloatModule_basic",
    "ArangeIntModule_basic",
    "ArangeNegativeStartFloatModule_basic",
    "ArangeNegativeStartIntModule_basic",
    "ArangeStartFloatModule_basic",
    "ArangeStartIntModule_basic",
    "ArangeStartNegativeStepFloatModule_basic",
    "ArangeStartNegativeStepIntModule_basic",
    "ArangeStartStepFloatModule_basic",
    "ArangeStartStepIntModule_basic",
    "ArangeZeroElementOutputModule_basic",
    "AvgPool2dCeilModeTrueModule_basic",
    "AvgPool2dDivisorOverrideModule_basic",
    "AvgPool2dFloatModule_basic",
    "AvgPool2dIntModule_basic",
    "AvgPool2dStaticModule_basic",
    "BernoulliFloatModule_basic",
    "BernoulliModule_basic",
    "BernoulliOnesModule_basic",
    "BernoulliTensorModule_basic",
    "BernoulliZerosModule_basic",
    "BincountMinlengthModule_basic",
    "BincountModule_basic",
    "BincountStaticSizeModule_basic",
    "BoolFloatConstantModule_basic",
    "BoolFloatFalseModule_basic",
    "BoolFloatTrueModule_basic",
    "BoolIntConstantModule_basic",
    "BoolIntFalseModule_basic",
    "BoolIntTrueModule_basic",
    "CeilFloatModule_basic",
    "DivFloatModule_basic",
    "DropoutTrainModule_basic",
    "ElementwiseAtenLogicalOrOpBrodcastModule_basic",
    "ElementwiseAtenLogicalOrOpDiffArgs1Module_basic",
    "ElementwiseAtenLogicalOrOpDiffArgs2Module_basic",
    "ElementwiseAtenLogicalOrOpDiffArgs3Module_basic",
    "ElementwiseAtenLogicalOrOpModule_basic",
    "ElementwiseAtenLogicalOrOpNegativeModule_basic",
    "ElementwiseAtenLogicalOrOpRandomFloatModule_basic",
    "ElementwiseAtenLogicalOrOpRandomModule_basic",
    "ElementwiseClampMaxModule_basic",
    "ElementwiseClampMinModule_basic",
    "ElementwiseClampModule_basic",
    "ElementwiseWhereScalarModule_basic",
    "ElementwiseWhereScalarOtherModule_basic",
    "ElementwiseWhereScalarSelfModule_basic",
    "ElementwiseWhereSelfModule_basic",
    "EmptyLikeMemoryFormatModule_basic",
    "EmptyLikeModule_defaultDtype",
    "EmptyLikeModule_falsePinMemory",
    "EmptyLikeModule_float",
    "EmptyLikeModule_int",
    "EmptyModule_contiguous",
    "EmptyModule_defaultDtype",
    "EmptyModule_falsePinMemory",
    "EmptyModule_float",
    "EmptyModule_int",
    "EqIntModule_basic",
    "Fill_TensorFloat64WithFloat32_basic",
    "Fill_TensorFloat64WithFloat64_basic",
    "Fill_TensorFloat64WithInt64_basic",
    "FullLikeModuleDefaultDtype_basic",
    "FullLikeModuleFalsePinMemory_basic",
    "FullLikeModuleFloat2D_basic",
    "FullLikeModuleFloat3DStatic_basic",
    "FullLikeModuleFloat3D_basic",
    "FullLikeModuleInt2DStatic_basic",
    "FullLikeModuleInt2D_basic",
    "FullLikeModuleInt3D_basic",
    "FullModuleDefaultDtype_basic",
    "FullModuleFalsePinMemory_basic",
    "FullModuleFloat2D_basic",
    "FullModuleFloat3D_basic",
    "FullModuleInt2D_basic",
    "FullModuleInt3D_basic",
    "GeFloatIntModule_basic",
    "GeFloatModule_basic",
    "GtFloatIntModule_basic",
    "GtIntModule_basic",
    "HBC_basic",
    "HardTanhIntModule_basic",
    "HardTanhModule_basic",
    "HardswishModule_basic",
    "HardswishRandomModule_basic",
    "IndexPut1DFloatAccumulateModule_basic",
    "IndexPut1DFloatNonAccumulateModule_basic",
    "IndexPut1DIntAccumulateModule_basic",
    "IndexPut1DIntNonAccumulateModule_basic",
    "IndexPut2DFloatAccumulateModule_basic",
    "IndexPut2DFloatNonAccumulateModule_basic",
    "IndexPut2DIntAccumulateModule_basic",
    "IndexPut2DIntNonAccumulateModule_basic",
    "IndexPut3DFloatAccumulateModule_basic",
    "IndexPut3DFloatNonAccumulateModule_basic",
    "IndexPut3DIntAccumulateModule_basic",
    "IndexPut3DIntNonAccumulateModule_basic",
    "IndexPutHackedTwin1DFloatAccumulateModule_basic",
    "IndexPutHackedTwin1DFloatNonAccumulateModule_basic",
    "IndexPutHackedTwin1DIntAccumulateModule_basic",
    "IndexPutHackedTwin1DIntNonAccumulateModule_basic",
    "IndexPutHackedTwin2DFloatAccumulateModule_basic",
    "IndexPutHackedTwin2DFloatNonAccumulateModule_basic",
    "IndexPutHackedTwin2DIntAccumulateModule_basic",
    "IndexPutHackedTwin2DIntNonAccumulateModule_basic",
    "IndexPutHackedTwin3DFloatAccumulateModule_basic",
    "IndexPutHackedTwin3DFloatNonAccumulateModule_basic",
    "IndexPutHackedTwin3DIntAccumulateModule_basic",
    "IndexPutHackedTwin3DIntNonAccumulateModule_basic",
    "IndexPutImpl1DFloatAccumulateModule_basic",
    "IndexPutImpl1DFloatNonAccumulateModule_basic",
    "IndexPutImpl1DIntAccumulateModule_basic",
    "IndexPutImpl1DIntNonAccumulateModule_basic",
    "IndexPutImpl2DFloatAccumulateModule_basic",
    "IndexPutImpl2DFloatNonAccumulateModule_basic",
    "IndexPutImpl3DFloatAccumulateModule_basic",
    "IndexPutImpl3DFloatNonAccumulateModule_basic",
    "IndexSelectDynamicIndexSizeModule_basic",
    "IndexSelectDynamicInputSizeModule_basic",
    "IndexSelectDynamicModulebasic",
    "IndexSelectSingleIdxModule_basic",
    "IndexSelectTwoIdxModule_basic",
    "IndexSelectWholeDimensionModule_basic",
    "IndexSelectWholeTensorModule_basic",
    "IndexTensorModule_basic",
    "MaskedFillScalarDefaultModule_basic",
    "MaskedFillScalarFloatValueModule_basic",
    "MaskedFillScalarIntValueModule_basic",
    "Matmul_dot",
    "Matmul_matvec",
    "Matmul_vecmat",
    "MaxPool2dCeilModeTrueModule_basic",
    "MaxPool2dModule_basic",
    "MaxPool2dStaticModule_basic",
    "MaxPool2dWith3dInputModule_basic",
    "MaxPool2dWithIndicesAllNegativeValuesModule_basic",
    "MaxPool2dWithIndicesAllOnesModule_basic",
    "MaxPool2dWithIndicesBackwardDynamic3DModule_basic",
    "MaxPool2dWithIndicesBackwardDynamic4DModule_basic",
    "MaxPool2dWithIndicesBackwardStatic3DModule_basic",
    "MaxPool2dWithIndicesBackwardStatic4DModule_basic",
    "MaxPool2dWithIndicesCeilModeTrueModule_basic",
    "MaxPool2dWithIndicesFullSizeKernelModule_basic",
    "MaxPool2dWithIndicesModule_basic",
    "MaxPool2dWithIndicesNonDefaultDilationModule_basic",
    "MaxPool2dWithIndicesNonDefaultPaddingModule_basic",
    "MaxPool2dWithIndicesNonDefaultParamsModule_basic",
    "MaxPool2dWithIndicesNonDefaultStrideModule_basic",
    "MaxPool2dWithIndicesStaticModule_basic",
    "MaxPool2dWithIndicesWith3dInputModule_basic",
    "MeanDimAllReduceKeepdimModule_basic",
    "MeanDimAllReduceModule_basic",
    "MeanDimDtypeModule_basic",
    "MeanDimKeepdimModule_basic",
    "MeanDimModule_basic",
    "MeanDimNegativeModule_basic",
    "MeanDtypeModule_basic",
    "MeanDynamicSizesModule_basic",
    "MeanModule_basic",
    "MobilenetV3Module_basic",
    "MulIntModule_basic",
    "NativeBatchNorm1DModule_basic",
    "NativeBatchNorm2DModule_basic",
    "NativeBatchNorm3DModule_basic",
    "NativeBatchNormNoneWeightModule_basic",
    "NativeLayerNormDynamicModule_basic",
    "NativeLayerNormModule_basic",
    "NeFloatIntModule_basic",
    "NeIntModule_basic",
    "NewEmptyModuleDefaultDtype_basic",
    "NewEmptyModuleFalsePinMemory_basic",
    "NewEmptyModuleFloat2D_basic",
    "NewEmptyModuleFloat3D_basic",
    "NewEmptyModuleInt2D_basic",
    "NewEmptyModuleInt3D_basic",
    "NewEmptyModuleLayoutIntDtype_basic",
    "NewEmptyModuleNonDefaultFloatDtype_basic",
    "NewEmptyModuleNonDefaultIntDtype_basic",
    "NewOnesModuleDefaultDtype_basic",
    "NewOnesModuleFalsePinMemory_basic",
    "NewOnesModuleFloat2D_basic",
    "NewOnesModuleFloat3D_basic",
    "NewOnesModuleInt2D_basic",
    "NewOnesModuleInt3D_basic",
    "NewZerosModuleDefaultDtype_basic",
    "NewZerosModuleFalsePinMemory_basic",
    "NewZerosModuleFloat2D_basic",
    "NewZerosModuleFloat3D_basic",
    "NewZerosModuleInt2D_basic",
    "NewZerosModuleInt3D_basic",
    "NllLossModuleBackward1DMeanWeight_basic",
    "NllLossModuleBackward1DMean_basic",
    "NllLossModuleBackward1DSumWeight_basic",
    "NllLossModuleBackward1DSum_basic",
    "NllLossModuleBackward1DWeight_basic",
    "NllLossModuleBackward1D_basic",
    "NllLossModuleBackwardMeanWeight_basic",
    "NllLossModuleBackwardMean_basic",
    "NllLossModuleBackwardSumWeight_basic",
    "NllLossModuleBackwardSum_basic",
    "NllLossModuleBackwardWeight_basic",
    "NllLossModuleBackward_basic",
    "NllLossModuleBackward_ignore_index",
    "NllLossModule_1D_basic",
    "NllLossModule_basic",
    "NllLossModule_ignore_index_out_of_bounds_basic",
    "NllLossModule_mean_basic",
    "NllLossModule_sum_basic",
    "NumelModule_basic",
    "NumelZeroRankModule_basic",
    "OnesLikeModule_defaultDtype",
    "OnesLikeModule_falsePinMemory",
    "OnesLikeModule_float",
    "OnesLikeModule_int",
    "OnesModuleDefaultDtype_basic",
    "OnesModuleFalsePinMemory_basic",
    "OnesModuleFloat_basic",
    "OnesModuleInt_basic",
    "QuantizedMLP_basic",
    "RandLikeDtypeModule_basic",
    "RandLikeModule_basic",
    "ReduceMaxKeepDimReturnBoth_basic",
    "ReduceMaxNegativeDim_basic",
    "ReshapeAliasCollapseModule_basic",
    "ReshapeAliasExpandModule_basic",
    "ReturnThreeTensorFloat32_basic",
    "ReturnTwoTensorF32I64_basic",
    "ScalarImplicitFloatModule_basic",
    "ScalarImplicitIntModule_basic",
    "SelectIntModule_basic",
    "SliceEndSleStartModule_basic",
    "SliceNegIdxModule_basic",
    "SliceOutOfLowerBoundEndIndexModule_basic",
    "SliceOutOfLowerBoundStartIndexModule_basic",
    "SliceOutOfUpperBoundIndexModule_basic",
    "SliceSingleIdxModule_basic",
    "SliceSizeTwoStepModule_basic",
    "SliceStartEqEndModule_basic",
    "SliceWholeTensorModule_basic",
    "SqrtIntConstantModule_basic",
    "SqrtIntModule_basic",
    "StdBiasedModule_basic",
    "StdUnbiasedModule_basic",
    "SubFloatModule_basic",
    "SubIntModule_basic",
    "TModuleRank0_basic",
    "TModuleRank1_basic",
    "TableBatchEmbeddingModule_basic",
    "TensorToBoolZeroRank_basic",
    "TensorToBool_basic",
    "TensorToFloatZeroRank_basic",
    "TensorToFloat_basic",
    "TensorToIntZeroRank_basic",
    "TensorToInt_basic",
    "TensorsConcatModule_basic",
    "TestMultipleTensorAndPrimitiveTypesReturn_basic",
    "TestMultipleTensorReturn_basic",
    "Threshold1dFloatModule_basic",
    "Threshold1dIntI32Module_basic",
    "Threshold1dIntModule_basic",
    "Threshold2dFloatModule_basic",
    "Threshold2dIntModule_basic",
    "Threshold3dFloatModule_basic",
    "Threshold3dIntModule_basic",
    "ThresholdBackward1dFloatModule_basic",
    "ThresholdBackward1dIntModule_basic",
    "ThresholdBackward1dMixedModule_basic",
    "ThresholdBackward2dFloatModule_basic",
    "ThresholdBackward2dIntModule_basic",
    "ThresholdBackward2dMixedModule_basic",
    "ThresholdBackward3dFloatModule_basic",
    "ThresholdBackward3dIntModule_basic",
    "ThresholdBackward3dMixedModule_basic",
    "TorchPrimLoopForLikeModule_basic",
    "TorchPrimLoopWhileLikeModule_basic",
    "UniformModule_basic",
    "UniformStaticModule_basic",
    "UnsafeViewCollapseDynamicWithAtenSizeIntModule_basic",
    "VarBiasedModule_basic",
    "VarUnbiasedModule_basic",
    "ViewCollapseDynamicWithAtenSizeIntModule_basic",
    "ZeroFloat32Module_basic",
    "ZeroInt32Module_basic",
    "ZeroInt64Module_basic",
    "ZerosLikeModule_defaultDtype",
    "ZerosLikeModule_falsePinMemory",
    "ZerosLikeModule_float",
    "ZerosLikeModule_int",
    "ZerosModuleDefaultDtype_basic",
    "ZerosModuleFalsePinMemory_basic",
    "ZerosModuleFloat2D_basic",
    "ZerosModuleFloat3D_basic",
    "ZerosModuleInt2D_basic",
    "ZerosModuleInt3D_basic",
}
